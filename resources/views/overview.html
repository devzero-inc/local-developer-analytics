<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Command Execution Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
</head>
<body class="p-5">
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <div class="p-4 shadow-lg rounded-lg">
        <canvas id="processesResourceUsage"></canvas>
    </div>
    <div class="p-4 shadow-lg rounded-lg">
        <canvas id="cpuTimeSeries"></canvas>
    </div>
    <div class="p-4 shadow-lg rounded-lg">
        <canvas id="memoryTimeSeries"></canvas>
    </div>
</div>
</body>
<script>
    (async function () {
        // Use the injected JSON data
        const processesChart = JSON.parse(`{{.ProcessesJSON}}`);
        const cpuTimeChart = JSON.parse(`{{.CPUTimeSeriesJSON}}`);
        const memoryTimeChart = JSON.parse(`{{.MemoryTimeSeriesJSON}}`);

        processesChart.options.plugins.tooltip = {
            callbacks: {
                beforeTitle: function (context) {
                    return context[0].raw.processName;
                },
            }
        };

        processesChart.data.datasets[0].pointRadius = function (context) {
            return context.raw.r;
        }

        new Chart(document.getElementById('memoryTimeSeries').getContext('2d'), memoryTimeChart);

        new Chart(document.getElementById('cpuTimeSeries').getContext('2d'), cpuTimeChart);

        new Chart(document.getElementById('processesResourceUsage'), processesChart);

    })();
</script>
</html>

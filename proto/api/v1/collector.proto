syntax = "proto3";

package api.v1;

import "google/protobuf/empty.proto";

option go_package = "lda/gen/api/v1;gen";
option java_multiple_files = true;
option java_package = "gen.api.v1";

message Command {
  int64 id = 1;
  int64 pid = 2;
  string category = 3;
  string command = 4;
  string user = 5;
  string directory = 6;
  int64 execution_time = 7;
  int64 start_time = 8;
  int64 end_time = 9;
}

message Process {
  int64 id = 1;
  int64 pid = 2;
  string name = 3;
  string status = 4;
  int64 start_time = 5;
  int64 end_time = 6;
  int64 execution_time = 7;
  string os = 8;
  string platform = 9;
  string platform_family = 10;
  float cpu_usage = 11;
  float used_memory = 12;
}

// Request definitions

message SendCommandsRequest {
  repeated Command commands = 1;
}

message SendProcessesRequest {
  repeated Process processes = 1;
}

// Service definition
service CollectorService {
  rpc SendCommands(SendCommandsRequest) returns (google.protobuf.Empty);
  rpc SendProcesses(SendProcessesRequest) returns (google.protobuf.Empty);
}
